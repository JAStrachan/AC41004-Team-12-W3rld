<!DOCTYPE html>
<html>
<head>
        <meta charset="utf-8"/>
        <meta name="Tommy Walton">
        <title>Data Loading</title>
</head>
<body>
    <ul id = "tempTime"></ul>
    <script>
        //Stores information about readings made at different intervals
        class Reading{
           constructor(ReadingDate, SensorReading){
                this.ReadingDate = ReadingDate;
                this.SensorReading = SensorReading;
            }
        }       
        //Takes in input of mode desired to be displayed and converts values to appropriate unit when being displayed
        function Conversion(temperatureFormat,value){
            switch(temperatureFormat){
                //Kelvin
                case "K":
                    return value;
                //Fahrenheit 
                case "F":
                    return (value*1.8)-459.67;
                //Celsius
                case "C":
                    return value-273.15;
            }
        }

        
        //Initialise sensor arrays
        let sensorOneReadings = [];
        let sensorTwoReadings = [];
        let sensorThreeReadings = [];
        let sensorFourReadings = [];

        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function(){
            //If ready to receive data, parse the input
            if(this.readyState == 4 && this.status == 200){
                let temperatureFormat = "K";
                let noOfSensors = 4;
                let response = JSON.parse(xhttp.responseText);
                let tempTime = response.tempTime;               
                let output = '';
                //Display each input in a list on the screen
                for(let i = 0; i < tempTime.length; i++){
                    output += '<li>'+tempTime[i].Sensor1+'</li>';
                    //Add sensor data into appropriate arrays
                    sensorOneReadings.push(new Reading(tempTime[i].Date,tempTime[i].Sensor1));
                    sensorTwoReadings.push(new Reading(tempTime[i].Date,tempTime[i].Sensor2));
                    sensorThreeReadings.push(new Reading(tempTime[i].Date,tempTime[i].Sensor3));
                    sensorFourReadings.push(new Reading(tempTime[i].Date,tempTime[i].Sensor4));
                    //Displays the average temperature of the 4 sensors
                    console.log((Conversion(temperatureFormat,tempTime[i].Sensor1)+Conversion(temperatureFormat,tempTime[i].Sensor2)+Conversion(temperatureFormat,tempTime[i].Sensor3)+Conversion(temperatureFormat,tempTime[i].Sensor4))/noOfSensors)
                }
                
                //Information inputed should be from the tempTime field in the JSON file
                document.getElementById('tempTime').innerHTML = output;
            }
        };
        //Read from data file
        xhttp.open("GET","TemperatureDataKelvin.json",true);
        xhttp.send();
    </script>
</body>
</html>